import axios from 'axios';

const API_URL = 'http://localhost:8000';

/**
 * Get yearly financial summary
 */
export const getYearlyFinancials = async () => {
  try {
    const response = await axios.get(`${API_URL}/api/financials/yearly`);
    return response.data;
  } catch (error) {
    console.error('Error fetching yearly financials:', error);
    // Return sample data if API fails
    return [
      { "year": 2025, "income": 132000, "expenses": 275000, "ebitda": -143000, "client_count": 820, "paying_clients": 560 },
      { "year": 2026, "income": 1350000, "expenses": 890000, "ebitda": 460000, "client_count": 3400, "paying_clients": 2800 },
      { "year": 2027, "income": 5200000, "expenses": 2450000, "ebitda": 2750000, "client_count": 10500, "paying_clients": 9200 },
      { "year": 2028, "income": 14800000, "expenses": 7300000, "ebitda": 7500000, "client_count": 27000, "paying_clients": 24500 },
      { "year": 2029, "income": 32500000, "expenses": 16200000, "ebitda": 16300000, "client_count": 58000, "paying_clients": 53000 }
    ];
  }
};

/**
 * Get monthly financial data
 */
export const getMonthlyFinancials = async () => {
  try {
    const response = await axios.get(`${API_URL}/api/financials/monthly`);
    return response.data;
  } catch (error) {
    console.error('Error fetching monthly financials:', error);
    return [];
  }
};

/**
 * Get all growth parameters
 */
export const getGrowthParameters = async () => {
  try {
    const response = await axios.get(`${API_URL}/api/parameters`);
    return response.data;
  } catch (error) {
    console.error('Error fetching growth parameters:', error);
    return null;
  }
};

/**
 * Update growth parameters and retrieve updated forecast
 */
export const updateGrowthParameters = async (params) => {
  try {
    const response = await axios.post(`${API_URL}/api/parameters/update`, params);
    return response.data;
  } catch (error) {
    console.error('Error updating growth parameters:', error);
    return { status: 'error', message: 'Failed to update parameters' };
  }
};

/**
 * Get staff summary data
 */
export const getStaffSummary = async () => {
  try {
    const response = await axios.get(`${API_URL}/api/staff/yearly`);
    return response.data;
  } catch (error) {
    console.error('Error fetching staff summary:', error);
    return [];
  }
};

/**
 * Get expense breakdown data
 */
export const getExpenseBreakdown = async () => {
  try {
    const response = await axios.get(`${API_URL}/api/expense-breakdown/monthly`);
    return response.data;
  } catch (error) {
    console.error('Error fetching expense breakdown:', error);
    return [];
  }
};

export default {
  getYearlyFinancials,
  getMonthlyFinancials,
  getGrowthParameters,
  updateGrowthParameters,
  getStaffSummary,
  getExpenseBreakdown
};